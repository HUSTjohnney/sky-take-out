1. 项目结构
   sky-common:
   sky-pojo:

- entity：主体，与数据库相关的类。
- dto：前端数据传回的时候，需要
  sky-server:

---

前端到后端不是直接访问的，中间会有 Nginx 进行反向代理。
Nginx 反向代理的好处：

- 提高访问速度：在这一层可以缓存、提前响应给前端。
- 进行负载均衡：将大量的请求按照我们指定的方式均衡的分配给集群中的每台服务器。
- 保证后端服务安全，通过前端无法直接请求到后端。Nginx 服务器可以放在内网/局域网里。
  上述都在 nginx.conf 里配置，前端的部分。

负载均衡策略：
轮询：默认策略；
权重：权重越高，被分配的客户端请求就越多；
ip_hash：依据 ip 分配方式，这样每个访客可以固定访问一个后端服务；
least_conn：优先分配连接数少的；
url_hash：相同的 url 被分配到同一个后端服务；
fair：依据响应时间，响应时间短的优先被服务；

员工表中的密码是明文存储，安全性太低。因此需要用加密算法进行加密后再进行存储。如 MD5 加密算法。

前后端分开开发的系统开发流程：

1. 定义接口：通过接口文档来定义。APIfox （设计阶段使用的）等接口管理网页进行接口定义、管理。接口的定义是 Json 文档。
2. 前端后端并行开发：两边再一起推进，前端后端一起推进。并且后端可以进行自测。
3. 连调：就是前后端一起联合调试，前端数据是否可以稳定传给后端/后端数据是否可以正常在前端展示？
4. 提测：交给专业的测试人员进行测试。

Postmen 可以进行端口的测试，但是仅限于参数少的时候。Swagger 是可以用于后端的测试。

###Swagger
功能：为后端生成接口文档，并进行测试。
Knife4j 为 Java MVC 框架集成 Swagger 生成 Api 文档。
步骤：

1. maven 中导入 knife4j 坐标： <knife4j>3.0.2</knife4j>
2. 配置类中加入相关配置：docket
3. 设置静态资源映射：addResourceHandlers

---

第二天：后端开发——需求分析
账号：主键、要求是唯一的。
手机号也无法随意录入：纯数字+11 位数。
性别：男/女
身份证号：11 位、合法。
密码默认为 123456

JSON 格式的数据来提交表单项。返回的格式也是 JSON 的。

管理端——统一使用/admin 作为前缀
用户端——统一使用/user 作为前缀

DTO ：

- 定义：DTO 主要用于在不同的层或不同的系统之间传输数据。它是一种简单的对象，通常只包含用于数据传输的属性和对应的 getter/setter 方法，没有业务逻辑。是封装的数据，进行接受数据——而不是直接用 Employee 类，因为前端提交的数据和最终的类也会有区别，因此约定设置一个 EmployeeDTO 类来接受前端的数据。VO 是视图的对象。
- 作用：例如，在一个多层架构的应用程序中，当从数据库中查询出数据后，为了将这些数据传递给前端或者其他服务，会将数据封装成 DTO 对象。这样可以避免将数据访问层（DAO）中的实体对象直接暴露出去，对数据进行一定程度的筛选和整理。假设我们有一个用户管理系统，从数据库中查询用户信息时，可能会查询出用户的密码等敏感信息，但在传输给前端展示时，不应该包含密码。此时就可以使用 DTO 来只传递需要展示的信息，如用户名、年龄、邮箱等。

VO（Value Object）：值对象
* 也是一个数据传输对象，强调是不可变的对象。

@Repository 注解表明这个接口是一个数据访问层的组件。

输入的异常，实际上有的前端处理不了：比如数据库发现主键不唯一。
但是有的可以在前端处理了：比如手机号是 11 位、身份证是 18 位、且要求数字等等。

### JWT

JWT 原理，是一种令牌校验，用于校验 JSON 数据的发送人，比如是用户端的数据、客户端的数据、是否是合法的数据等等。主要功能就是身份认证与授权、安全性为主，防止传入的 JSON 是伪造的。
流程：

1. 用户认证——>后端认证通过
2. 后端生成 JWT token，返回给前端
3. 之后前端的所有操作都会在请求头中携带 JWT Token，每次后端接受到操作时，都会进行拦截（JWTTOKENAdminInterceptor 类的作用）
4. 如果拦截是通过的，则执行业务逻辑，并给前端返回数据。
5. 如果拦截不通过，则展示错误信息（401）。

### ThreadLocal

ThreadLocal 并不是一个 Thread，而是 Thread 的局部变量。它为线程提供单独一份的存储空间，具有线程隔离的效果，只有线程内才能获取到对应的值，线程外无法访问。

### Mybatis

有个一个 PageHelper 类，可以帮助分页查询的类实现。

### 前后端调试响应码

401：无权限，JWT 令牌不通过。JWT 令牌是存在有效时间的，在 application.yml 中配置，目前有效期是 2 小时。
404：网络连接异常。
